function loop(){window.requestAnimationFrame(loop),tick+=opts.hueSpeed,ctx.shadowBlur=0,ctx.fillStyle="rgba(32,35,45,alp)".replace("alp",opts.repaintAlpha),ctx.fillRect(0,0,w,h);for(var a=0;a<opts.picksParTick;++a)hexs[Math.random()*hexs.length|0].pick();hexs.map(function(a){a.step()})}function Hex(a,b){this.x=a,this.y=b,this.sum=this.x+this.y,this.picked=!1,this.time=0,this.targetTime=0,this.xs=[this.x+cos,this.x,this.x-cos,this.x-cos,this.x,this.x+cos],this.ys=[this.y-sin,this.y-opts.side,this.y-sin,this.y+sin,this.y+opts.side,this.y+sin]}var w=dotty.width=window.innerWidth,h=dotty.height=window.innerHeight,sum=w+h,ctx=dotty.getContext("2d"),opts={side:15,picksParTick:2,baseTime:40,addedTime:10,colors:["rgba(49,56,141,alp)","rgba(254,8,97,alp)","rgba(253,255,86,alp)"],addedAlpha:20,strokeColor:"rgb(43,45,53)",hueSpeed:.2,repaintAlpha:1},difX=Math.sqrt(3)*opts.side/2,difY=3*opts.side/2,rad=Math.PI/6,cos=Math.cos(rad)*opts.side,sin=Math.sin(rad)*opts.side,hexs=[],tick=0;Hex.prototype.pick=function(){this.color=opts.colors[Math.random()*opts.colors.length|0],this.picked=!0,this.time=this.time||0,this.targetTime=this.targetTime||opts.baseTime+opts.addedTime*Math.random()|0},Hex.prototype.step=function(){var a=this.time/this.targetTime;ctx.beginPath(),ctx.moveTo(this.xs[0],this.ys[0]);for(var b=1;b<this.xs.length;++b)ctx.lineTo(this.xs[b],this.ys[b]);ctx.lineTo(this.xs[0],this.ys[0]),this.picked?(++this.time,this.time>=this.targetTime&&(this.time=0,this.targetTime=0,this.picked=!1),ctx.fillStyle=ctx.shadowColor=this.color.replace("alp",Math.sin(a*Math.PI)),ctx.fill()):(ctx.strokeStyle=ctx.shadowColor=opts.strokeColor,ctx.stroke())};for(var x=0;x<w;x+=2*difX)for(var i=0,y=0;y<h;y+=difY)++i,hexs.push(new Hex(x+difX*(i%2),y));loop(),window.addEventListener("resize",function(){w=dotty.width=window.innerWidth,h=dotty.height=window.innerHeight,sum=w+h,hexs.length=0;for(var a=0;a<w;a+=2*difX)for(var b=0,c=0;c<h;c+=difY)++b,hexs.push(new Hex(a+difX*(b%2),c))});